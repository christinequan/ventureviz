<!DOCTYPE html>
<html lang="en">

<title>Venture Viz</title>
<head>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

    <meta charset="utf-8">
    
    <link href="style.css" rel="stylesheet">
    <link rel="stylesheet" href="font-awesome-4.6.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">

    <script charset="utf-8" src="https://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript"></script>
    <script src="d3-tip-master/index.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="VCviz.js" type="text/javascript"></script>

</head>

<header>        
      <h1>Venture Viz</h1>
    <a href="#something" id="toggle"><h1>
    About</h1></a>
    <h2>A visualization of investments in the startup world</h2>
    <div id="contact">

    <img src="http://www.myiconfinder.com/uploads/iconsets/128-128-cfa0efaebe8f48f8e0588310eae67f40.png"><br><br>
    <h2>
    What is Venture Viz?
    </h2>

    We are a group looking to visualize trends within the startup ecosystem in the United States. Using data scraped from Crunchbase, we've produced a visualization of the latest investments around the nation.
    <br><br>

    <h2>
    Credits and Acknowledgement
    </h2>
    CS 448B: Data Visualization
    <br> Stanford University

    </div>
</header>

<body>

    <div class="pure-menu custom-restricted-width">
        <span class="pure-menu-heading">Industries</span>

        <ul class="pure-menu-list">
            <li class="pure-menu-item"><a id="biotech" href="#" onclick="loadView(this.id)" class="pure-menu-link">Biotech</a></li>
            <li class="pure-menu-item"><a id="cleantech" href="#" onclick="loadView(this.id)" class="pure-menu-link">Cleantech</a></li>
            <li class="pure-menu-item"><a id="enterprise" href="#" onclick="loadView(this.id)" class="pure-menu-link">Enterprise</a></li>
            <li class="pure-menu-item"><a id="ecommerce" href="#" onclick="loadView(this.id)" class="pure-menu-link">eCommerce</a></li>
            <li class="pure-menu-item"><a id="hardware" href="#" onclick="loadView(this.id)" class="pure-menu-link">Hardware</a></li>
            <li class="pure-menu-item"><a id="health" href="#" onclick="loadView(this.id)" class="pure-menu-link">Health</a></li>
            <li class="pure-menu-item"><a id="mobile" href="#" onclick="loadView(this.id)" class="pure-menu-link">Mobile</a></li>
            <li class="pure-menu-item"><a id="security" href="#" onclick="loadView(this.id)" class="pure-menu-link">Security</a></li>
            <li class="pure-menu-item"><a id="semiconductors" href="#" onclick="loadView(this.id)" class="pure-menu-link">Semiconductors</a></li>
            <li class="pure-menu-item"><a id="software" href="#" onclick="loadView(this.id)" class="pure-menu-link">Software</a></li>

        </ul>
    </div>

    <script type="text/javascript">

        var svg = d3.select("body")
            .append("svg")
            .attr('class', 'svg')
            .attr("width", w+100)
            .attr("height", h+50)
            .on('mouseout', function() {reDraw();});


        var tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) {
                return tooltipText(d);
            });

        svg.call(tip);

        var biotechURL = "https://dl.dropboxusercontent.com/s/s5es35mg6o9p46k/biotechnology_small.csv?dl=0"
        var cleantechURL = "https://dl.dropboxusercontent.com/s/okm33b2iv71taco/cleantechnology_small.csv?dl=0"
        var curatedwebURL = "https://dl.dropboxusercontent.com/s/1gih7rk2bsyey6a/curatedweb_usa.csv?dl=0"
        var enterpriseURL = "https://dl.dropboxusercontent.com/s/ly416w9oorr6kl3/enterprisesoftware_small.csv?dl=0"
        var ecommerceURL = "https://dl.dropboxusercontent.com/s/nku5vpjrkerd8ab/e-commerce_small.csv?dl=0"
        var hardwareURL = "https://dl.dropboxusercontent.com/s/zpsmyfucttf52jo/hardwareandsoftware_usa.csv?dl=0"
        var healthURL = "https://dl.dropboxusercontent.com/s/3r9tvdxfgmf2l5d/healthcare_small.csv?dl=0"
        var mobileURL = "https://dl.dropboxusercontent.com/s/vcocjoycs5rcqjy/mobile_small.csv?dl=0"
        var securityURL =   "https://dl.dropboxusercontent.com/s/7cq9nihvkvwqzqf/security_small.csv?dl=0"
        var semiconductorsURL = "https://dl.dropboxusercontent.com/s/xs8m0tz53m445br/semiconductors_small.csv?dl=0"
        var softwareURL = "https://dl.dropboxusercontent.com/s/tkdfwszqiyuynp0/software_small.csv?dl=0"
        /* Preload all of the industry data into objects */
        var biotechData, cleantechData, curatedwebData, enterpriseData, ecommerceData, hardwareData, healthData, mobileData, securityData, semiconductorsData, softwareData;

        function loadData() {
            queue()
            .defer(d3.csv, biotechURL)
            .defer(d3.csv, cleantechURL)
            .defer(d3.csv, curatedwebURL)
            .defer(d3.csv, enterpriseURL)
            .defer(d3.csv, ecommerceURL)
            .defer(d3.csv, hardwareURL)
            .defer(d3.csv, healthURL)
            .defer(d3.csv, mobileURL)
            .defer(d3.csv, securityURL)
            .defer(d3.csv, semiconductorsURL)
            .defer(d3.csv, softwareURL)
            .await(visualizeData);
        }

        loadData();

        function visualizeData(error, biotechData_L, cleantechData_L, curatedwebData_L, enterpriseData_L, ecommerceData_L, hardwareData_L, healthData_L, mobileData_L, securityData_L, semiconductorsData_L, softwareData_L) {
            if (error) throw error;
            biotechData = biotechData_L;
            cleantechData = cleantechData_L;
            curatedwebData = curatedwebData_L;
            enterpriseData = enterpriseData_L;
            ecommerceData = ecommerceData_L;
            hardwareData = hardwareData_L;
            healthData = healthData_L;
            mobileData = mobileData_L;
            securityData = securityData_L;
            semiconductorsData = semiconductorsData_L;
            softwareData = softwareData_L;

        }


        function showStartup() {
            var name = document.getElementById("startup-search").value.toLowerCase();
            var matches = 0;
            resetTextForStartup();
            console.log(name);
            svg.selectAll("rect")
                .attr("opacity", function() {return "0"});
            svg.selectAll("rect")
                .data(data)
                // .enter() // do I need this line?
                .filter(function(d) { 
                    console.log(d);
                    console.log(d.company_name);
                    var bool = d.company_name.toLowerCase() === name;
                    if (bool) {
                        matches++;
                        showTextForStartup(d);
                    }
                    return bool;
                })
                .attr("opacity", function(d) {
                    return "1"
                });
        }

        function tooltipText(d) {
            var company = d.company_name;
            var response = "<h3>" + company + "</h3>";
            if (d.funding_round_type == "venture") {
                response += "<u>Series " + d.funding_round_code +"</u><br>";
            } else if (d.funding_round_type == "seed") {
                response += "<u>Seed Round</u>"+"<br>";
            } else if (d.funding_round_type == "angel") {
                response += "<u>Angel Investment</u>"+"<br>";
            } else {
                response += "<u>Other Investment</u>"+"<br>";
            }

            response += "$" + d.raised_amount_usd + "<p></p>";
            response += "<u>Investors</u><br>";
            for (var i = 1; i < 27; i++) {
                var property = String(investor_string + i);
                if (d[property] === "NA") break;
                response += d[property] + ", ";
            }
            response += "<br><br>Funded: " + d.funded_at;
            return response;
        }

        function showTextForStartup(d) {
            document.getElementById("results").innerHTML += tooltipText(d);
        }

        function resetTextForStartup() {
            // console.log(document.getElementById("results").innerHTML);
            document.getElementById("results").innerHTML = "";

        }

        // Changes colors

        function colorOver(point){
            // d3.select(this).style('fill','grey');
            console.log("Coloring over");
            console.log(point);
            svg.selectAll("rect")
                .attr("opacity", function() {return "0.1"});
            svg.selectAll("rect")
                .data(data)
                // .enter() // do I need this line?
                .filter(function(d) { 
                    console.log(d);
                    console.log(d.company_name);
                    return d.company_name === point.company_name;
                })
                .attr("opacity", function(d) {return "1"});
        }

        function colorOut(point) {
            var rect = d3.select(this);
            rect.style("fill", function(d) {
                return d.color;
            });
        }

        // Changes the view to the correct industry
        function loadView(clicked_id) {
            
            switch(clicked_id) {
                case 'biotech': data = biotechData; break;
                case 'cleantech': data = cleantechData; break;
                case 'enterprise': data = enterpriseData; break;
                case 'ecommerce': data = ecommerceData; break;
                case 'gaming': data = gamingData; break;
                case 'hardware': data = hardwareData; break;
                case 'health': data = healthData; break;
                case 'mobile': data = mobileData; break;
                case 'security': data = securityData; break;
                case 'semiconductors': data = semiconductorsData; break;
                case 'software': data = softwareData; break;
        }

        reDraw();
    }


    </script>
<table>
<tr>
    <td><div id="slider_container">
        <div class = "slider" id = "time_slide_form">
            <div id="slider-range"></div>
            <label for="amount"><b>Date Range</b></label> <input type="text" id="amount" style="border: 0; color: #000; font-weight: bold;" size="50"/>
        </div>

        <div class = "slider" id = "time_slide_form">
            <div id="amt-range"></div>
            <label for="raised"><b>Amount Raised</b></label> <input type="text" id="raised" style="border: 0; color: #000; font-weight: bold;" size="50"/>
        </div>
            
    </div></td>
    <td>
        <form class="pure-form">
            <label for="option-two" class="pure-radio">
                <input id="option-two" type="radio" name="optionsRadios" value="option1" checked>
                Search by startup
            </label>

            <label for="option-three" class="pure-radio">
                <input id="option-three" type="radio" name="optionsRadios" value="option2">
                Search by investors
            </label>
        </form>
    </td>

    <td>
        <div>
            <form class="pure-form">
                <input type="text" class="pure-input-rounded" placeholder="Startup" id="startup-search">
                <button class="pure-button" onclick="showStartup()">Search</button>
            </form>
        </div>
    </td>

    <td>
        <div>
            <form class="pure-form">
                <input type="text" class="pure-input-rounded" placeholder="Investor">
                <button class="pure-button">Search</button>
            </form>
        </div>
    </td>
    <td>
        <div id="results">
        </div>
    </td>
</tr>

 
</table>

    

</body>
</html>
